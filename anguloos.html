<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/5.10.4/mqtt.min.js" integrity="sha512-U6juml/sd5ivQOO5Nmd3IB8DUgRYRJ3whk/+oxaOJHyA9WtXXl3p42YoevQ7/PnuZR1Oir607H3A/+AjQ/gWug==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    const client = mqtt.connect("ws://10.50.0.181:9001");
    const usedColor = '#f8cecc';
    const freeColor = '#d5e8d4';

    client.on("connect", () => {
      client.subscribe("europalaan/#", (err) => {
        if (!err) {
          console.log("Subscribed")
        } else {
          console.log("Het gaat mis: ", err)
        }
      });
    });

    client.on("message", (topic, message) => {
      if (topic.split('/')[2] === 'presence_sensor') {
        document.querySelector('#' + topic.split('/')[1] + ' rect').setAttribute('fill', new TextDecoder().decode(message) === 'free' ? freeColor : usedColor);
      }
    });
  </script>
</head>
<body>
  <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="1132px"
       height="693px" viewBox="-0.5 -0.5 1132 693"
       style="background-color: rgb(255, 255, 255);">
    <defs/>
    <rect fill="#ffffff" width="100%" height="100%" x="0" y="0"/>
    <g>
      <g>
        <rect x="0" y="0" width="1130" height="690" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="lovelace">
        <rect x="0" y="320" width="120" height="200" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="engelbart">
        <rect x="190" y="320" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="shannon">
        <rect x="190" y="410" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="turing">
        <rect x="190" y="500" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all"/>
      </g>
      <g>
        <rect x="10" y="210" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/>
      </g>
      <g>
        <rect x="10" y="60" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00" pointer-events="all"/>
      </g>
      <g>
        <rect x="240" y="15" width="70" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00"
              transform="rotate(90,275,45)" pointer-events="all"/>
      </g>
      <g>
        <rect x="310" y="100" width="120" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="conway">
        <rect x="416" y="15" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,476,60)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="hopper">
        <rect x="510" y="15" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,570,60)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="hamilton">
        <rect x="604" y="15" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,664,60)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="torvalds">
        <rect x="698" y="15" width="120" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,758,60)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="lovelace">
        <rect x="792" y="15" width="120" height="90" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)"
              transform="rotate(90,852,60)" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="ritchie">
        <rect x="905" y="0" width="50" height="50" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,930,25)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="stallman">
        <rect x="905" y="55" width="50" height="50" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,930,80)"
              pointer-events="all"/>
      </g>
      <g>
        <rect x="1020" y="15" width="70" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00"
              transform="rotate(90,1055,45)" pointer-events="all"/>
      </g>
      <g class="meeting-room" id="cerfkahn">
        <rect x="1070" y="160" width="60" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(-180,1100,205)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="bernerslee">
        <rect x="1006" y="160" width="60" height="90" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(-180,1036,205)"
              pointer-events="all"/>
      </g>
      <g class="meeting-room" id="hinton">
        <rect x="1005" y="255" width="120" height="120" fill="#dae8fc" stroke="#6c8ebf" transform="rotate(90,1065,315)"
              pointer-events="all"/>
      </g>
      <g>
        <rect x="460" y="230" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00"
              transform="rotate(90,510,260)" pointer-events="all"/>
      </g>
      <g>
        <rect x="598" y="230" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00"
              transform="rotate(90,648,260)" pointer-events="all"/>
      </g>
      <g>
        <rect x="740" y="230" width="100" height="60" rx="9" ry="9" fill="#ffe6cc" stroke="#d79b00"
              transform="rotate(90,790,260)" pointer-events="all"/>
      </g>
      <g>
        <rect x="313" y="170" width="120" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)"
              pointer-events="all"/>
      </g>
      <g>
        <path d="M 310 320 L 863 319" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
      </g>
      <g>
        <path d="M 432 322 L 433 190" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
      </g>
      <g>
        <rect x="814" y="249" width="120" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)"
              transform="rotate(90,874,259)" pointer-events="all"/>
      </g>
      <g>
        <rect x="862" y="222" width="120" height="74" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)"
              transform="rotate(90,922,259)" pointer-events="all"/>
      </g>
      <g>
        <path d="M 309.62 690 L 310 590" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10"
              pointer-events="stroke"/>
      </g>
      <g>
        <path d="M 864 690 L 864 319" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/>
      </g>
    </g>
  </svg>
</body>
</html>
